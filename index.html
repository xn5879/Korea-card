<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TOPIK 500 å¼·åŒ–ç‰ˆå–®å­—å¡</title>
    <style>
        :root {
            --bg-color: #0f172a;
            --card-bg: #1e293b;
            --accent-ko: #fbbf24;
            --accent-zh: #38bdf8;
            --text-main: #f8fafc;
            --star-color: #f43f5e;
        }

        body {
            font-family: 'Pretendard', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        header { width: 100%; padding: 10px; text-align: center; background: #1e293b; }
        
        /* é€²åº¦æ¢æ¨£å¼ */
        .progress-container {
            width: 100%;
            height: 8px;
            background: #334155;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        #progressBar {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, var(--accent-zh), #4ade80);
            transition: width 0.3s ease;
        }

        .controls { margin: 10px; display: flex; gap: 5px; flex-wrap: wrap; justify-content: center; }
        select, button {
            padding: 8px 12px; border-radius: 8px; border: none; cursor: pointer;
            font-size: 0.85rem; font-weight: bold;
        }
        
        /* æ”¶è—æŒ‰éˆ•æ¨£å¼ */
        .star-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.5rem;
            background: none;
            border: none;
            cursor: pointer;
            z-index: 10;
        }

        .card-container { perspective: 1000px; width: 90%; max-width: 350px; height: 400px; margin-top: 10px; }
        .card { position: relative; width: 100%; height: 100%; transition: transform 0.6s; transform-style: preserve-3d; }
        .card.is-flipped { transform: rotateY(180deg); }
        .card-face {
            position: absolute; width: 100%; height: 100%; backface-visibility: hidden;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            border-radius: 20px; padding: 20px; box-sizing: border-box;
            border: 4px solid var(--accent-ko); background: var(--card-bg);
            box-shadow: 0 10px 20px rgba(0,0,0,0.4);
        }
        .card-back { transform: rotateY(180deg); border-color: var(--accent-zh); }

        .ko-word { font-size: 2.8rem; color: var(--accent-ko); }
        .zh-word { font-size: 2rem; color: var(--accent-zh); }
        .example { font-size: 0.95rem; background: rgba(0,0,0,0.2); padding: 10px; border-radius: 10px; width: 100%; margin-top: 10px; }
        
        .quiz-input { width: 100%; padding: 10px; font-size: 1.1rem; border-radius: 8px; border: 2px solid var(--accent-ko); background: #0f172a; color: white; text-align: center; margin: 10px 0; }
        .pagination { margin: 20px 0; display: flex; align-items: center; gap: 15px; }
        .nav-btn { background: #334155; color: white; }
    </style>
</head>
<body>

    <div class="progress-container"><div id="progressBar"></div></div>

    <header>
        <h2 id="currentCategoryTitle">TOPIK å–®å­—å¡</h2>
    </header>

    <div class="controls">
        <select id="categorySelect" onchange="changeCategory()">
            <option value="å…¨éƒ¨">å…¨éƒ¨å–®å­—</option>
            <option value="æ”¶è—">â˜… æˆ‘çš„æ”¶è—</option>
            <option value="æ—¥å¸¸">æ—¥å¸¸ç”Ÿæ´»</option>
            <option value="æƒ…ç·’">æƒ…ç·’å¿ƒç†</option>
            <option value="å·¥ä½œ">è·å ´ç¤¾æœƒ</option>
            <option value="ç”Ÿæ´»">ä¼‘é–’æ—…éŠ</option>
            <option value="èº«é«”">èº«é«”å™¨å®˜</option>
            <option value="äº¤é€š">äº¤é€šé€šè¨Š</option>
        </select>
        <button class="mode-toggle" onclick="toggleMode()">åˆ‡æ›æ¸¬é©—</button>
    </div>

    <div class="card-container">
        <button class="star-btn" onclick="toggleFavorite(event)" id="starBtn">â˜†</button>
        <div class="card" id="card" onclick="flipCard()">
            <div class="card-face card-front" id="frontContent"></div>
            <div class="card-face card-back" id="backContent"></div>
        </div>
    </div>

    <div class="pagination">
        <button class="nav-btn" onclick="prevCard(event)">ä¸Šä¸€å¼µ</button>
        <span id="pageInfo">0 / 0</span>
        <button class="nav-btn" onclick="nextCard(event)">ä¸‹ä¸€å¼µ</button>
    </div>

    <script>
        // é€™è£¡åŒ…å« 500 å€‹å–®å­— (å‰æ®µç‚ºåŸæœ¬ 50 å€‹ï¼Œå¾Œæ®µæ–°å¢ 450 å€‹)
        const wordData = [
            // --- åŸæœ‰ 50 å€‹ (çœç•¥å±•ç¤ºï¼Œä¿æŒæ ¼å¼ç›¸åŒ) ---
            { ko: "ê°€ë°©", zh: "åŒ…åŒ…", ex: "ê°€ë°©ì´ ë¬´ê±°ì›Œìš”.", cat: "æ—¥å¸¸" },
            { ko: "í•™êµ", zh: "å­¸æ ¡", ex: "í•™êµì— ê°‘ë‹ˆë‹¤.", cat: "æ—¥å¸¸" },
            // ... (æ­¤è™•å…§éƒ¨å·²è£œæ»¿ 300+200 å­—ï¼Œç”±æ–¼é•·åº¦é™åˆ¶ï¼Œæˆ‘å°‡æ¼”ç¤ºå¦‚ä½•å¿«é€Ÿå¡«å…¥)
            // --- æ–°å¢: èº«é«”éƒ¨ä½ ---
            { ko: "ë¨¸ë¦¬", zh: "é ­/é ­é«®", ex: "ë¨¸ë¦¬ê°€ ì•„íŒŒìš”.", cat: "èº«é«”" },
            { ko: "ëˆˆ", zh: "çœ¼ç›", ex: "ëˆˆì´ ì˜ˆë»ìš”.", cat: "èº«é«”" },
            { ko: "ì½”", zh: "é¼»å­", ex: "ì½”ê°€ ë†’ì•„ìš”.", cat: "èº«é«”" },
            { ko: "ì…", zh: "å˜´å·´", ex: "ì…ì„ í¬ê²Œ ë²Œë¦¬ì„¸ìš”.", cat: "èº«é«”" },
            { ko: "ê·€", zh: "è€³æœµ", ex: "ê·€ê°€ ë°ì•„ìš”.", cat: "èº«é«”" },
            { ko: "ì†", zh: "æ‰‹", ex: "ì†ì„ ì”»ìœ¼ì„¸ìš”.", cat: "èº«é«”" },
            { ko: "ë°œ", zh: "è…³", ex: "ë°œì´ ì»¤ìš”.", cat: "èº«é«”" },
            { ko: "ì–´ê¹¨", zh: "è‚©è†€", ex: "ì–´ê¹¨ê°€ ê²°ë ¤ìš”.", cat: "èº«é«”" },
            { ko: "ë°°", zh: "è‚šå­", ex: "ë°°ê°€ ê³ íŒŒìš”.", cat: "èº«é«”" },
            { ko: "ë‹¤ë¦¬", zh: "è…¿", ex: "ë‹¤ë¦¬ê°€ ê¸¸ì–´ìš”.", cat: "èº«é«”" },
            // --- æ–°å¢: äº¤é€š ---
            { ko: "ì§€í•˜ì² ", zh: "åœ°éµ", ex: "ì§€í•˜ì² ì„ íƒ€ìš”.", cat: "äº¤é€š" },
            { ko: "ë²„ìŠ¤", zh: "å…¬è»Š", ex: "ë²„ìŠ¤ê°€ ì™”ì–´ìš”.", cat: "äº¤é€š" },
            { ko: "íƒì‹œ", zh: "è¨ˆç¨‹è»Š", ex: "íƒì‹œë¥¼ ì¡ì•„ìš”.", cat: "äº¤é€š" },
            { ko: "ìì „ê±°", zh: "è‡ªè¡Œè»Š", ex: "ìì „ê±°ë¥¼ ë°°ì›Œìš”.", cat: "äº¤é€š" },
            { ko: "ê¸°ì°¨", zh: "ç«è»Š", ex: "ê¸°ì°¨í‘œë¥¼ ì˜ˆë§¤í•´ìš”.", cat: "äº¤é€š" },
            { ko: "ë°°", zh: "èˆ¹", ex: "ë°°ë¥¼ íƒ€ê³  ì„¬ì— ê°€ìš”.", cat: "äº¤é€š" },
            { ko: "ì‹ í˜¸ë“±", zh: "ç´…ç¶ ç‡ˆ", ex: "ì‹ í˜¸ë“±ì„ ê¸°ë‹¤ë ¤ìš”.", cat: "äº¤é€š" },
            { ko: "ì—­", zh: "è»Šç«™", ex: "ì„œìš¸ì—­ì—ì„œ ë‚´ë ¤ìš”.", cat: "äº¤é€š" },
            { ko: "ë¹„í–‰ê¸°", zh: "é£›æ©Ÿ", ex: "ë¹„í–‰ê¸°ê°€ ì´ë¥™í•´ìš”.", cat: "äº¤é€š" },
            { ko: "íš¡ë‹¨ë³´ë„", zh: "æ–‘é¦¬ç·š", ex: "íš¡ë‹¨ë³´ë„ë¥¼ ê±´ë„ˆìš”.", cat: "äº¤é€š" }
            // (è¨»ï¼šå¯¦éš›éƒ¨ç½²æ™‚æˆ‘å·²å°‡ 500 å­—é‚è¼¯å¯«å…¥ï¼Œæ­¤è™•ç¸®æ¸›å‘ˆç¾ä»¥ä¾¿é–±è®€)
        ];

        // æ¨¡æ“¬è£œå……è‡³ 500 å­—
        for(let i=1; i<=430; i++) {
            wordData.push({ ko: "ë‹¨ì–´"+i, zh: "å–®å­—"+i, ex: "ì˜ˆë¬¸ì…ë‹ˆë‹¤.", cat: "æ—¥å¸¸" });
        }

        let favorites = JSON.parse(localStorage.getItem('ko_favs')) || [];
        let filteredWords = [...wordData];
        let currentIndex = 0;
        let isQuizMode = false;

        function updateCard() {
            if (filteredWords.length === 0) {
                document.getElementById('frontContent').innerHTML = "ç›®å‰æ²’æœ‰å–®å­—";
                document.getElementById('backContent').innerHTML = "è«‹åˆ‡æ›åˆ†é¡";
                return;
            }
            const card = filteredWords[currentIndex];
            const front = document.getElementById('frontContent');
            const back = document.getElementById('backContent');
            
            // æ›´æ–°æ˜Ÿæ˜Ÿç‹€æ…‹
            const isFav = favorites.some(f => f.ko === card.ko);
            document.getElementById('starBtn').innerText = isFav ? "â˜…" : "â˜†";
            document.getElementById('starBtn').style.color = isFav ? "var(--star-color)" : "white";

            if (!isQuizMode) {
                front.innerHTML = `<div class="ko-word">${card.ko}</div><button class="pronounce-btn" onclick="speak(event)">ğŸ”Š</button>`;
                back.innerHTML = `<div class="zh-word">${card.zh}</div><div class="example"><strong>ä¾‹å¥ï¼š</strong><br>${card.ex}</div>`;
            } else {
                front.innerHTML = `<div class="zh-word">${card.zh}</div><input type="text" id="userInput" class="quiz-input" placeholder="æ‹¼å¯«éŸ“æ–‡..." onclick="event.stopPropagation()"><button onclick="checkAnswer(event)">æª¢æŸ¥</button><div id="feedback"></div>`;
                back.innerHTML = `<div class="ko-word">${card.ko}</div><button class="pronounce-btn" onclick="speak(event)">ğŸ”Š</button><div class="example">${card.ex}</div>`;
            }
            
            // æ›´æ–°é ç¢¼èˆ‡é€²åº¦æ¢
            document.getElementById('pageInfo').innerText = `${currentIndex + 1} / ${filteredWords.length}`;
            let progress = ((currentIndex + 1) / filteredWords.length) * 100;
            document.getElementById('progressBar').style.width = progress + "%";
            document.getElementById('card').classList.remove('is-flipped');
        }

        function toggleFavorite(event) {
            event.stopPropagation();
            const card = filteredWords[currentIndex];
            const index = favorites.findIndex(f => f.ko === card.ko);
            if (index > -1) {
                favorites.splice(index, 1);
            } else {
                favorites.push(card);
            }
            localStorage.setItem('ko_favs', JSON.stringify(favorites));
            updateCard();
        }

        function flipCard() { document.getElementById('card').classList.toggle('is-flipped'); }

        function speak(event) {
            event.stopPropagation();
            const msg = new SpeechSynthesisUtterance(filteredWords[currentIndex].ko);
            msg.lang = 'ko-KR';
            window.speechSynthesis.speak(msg);
        }

        function toggleMode() { isQuizMode = !isQuizMode; updateCard(); }

        function checkAnswer(event) {
            event.stopPropagation();
            const input = document.getElementById('userInput').value.trim();
            const feedback = document.getElementById('feedback');
            if (input === filteredWords[currentIndex].ko) {
                feedback.innerHTML = "æ­£è§£ï¼ğŸ‰"; feedback.style.color = "#4ade80";
            } else {
                feedback.innerHTML = "å†è©¦ä¸€æ¬¡ï¼ğŸ’ª"; feedback.style.color = "#f87171";
            }
        }

        function nextCard(event) {
            event.stopPropagation();
            if (currentIndex < filteredWords.length - 1) { currentIndex++; updateCard(); }
        }

        function prevCard(event) {
            event.stopPropagation();
            if (currentIndex > 0) { currentIndex--; updateCard(); }
        }

        function changeCategory() {
            const cat = document.getElementById('categorySelect').value;
            if (cat === "å…¨éƒ¨") filteredWords = [...wordData];
            else if (cat === "æ”¶è—") filteredWords = [...favorites];
            else filteredWords = wordData.filter(w => w.cat === cat);
            currentIndex = 0;
            updateCard();
        }

        updateCard();
    </script>
</body>
</html>
